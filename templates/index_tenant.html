{% extends "base.html" %}
{% load bootstrap3 %}

{% block titulo %}
    Inicio - SIND COLDEPORTES
{% endblock %}

{% block titulo_contenido %}
    Panel de Control
{% endblock %}

{% block miga_pan %}
    <li><a href="{% url 'inicio' %}">Inicio</a></li>
{% endblock %}

{% block js %}
    <script type="text/javascript" src="{{STATIC_URL}}js/coldeportes/arrayToJson.js"></script>
    <script src="{{STATIC_URL}}amcharts/amcharts.js" type="text/javascript"></script>
    <script src="{{STATIC_URL}}amcharts/serial.js" type="text/javascript"></script>
    <script src="{{STATIC_URL}}amcharts/exporting/amexport.js" type="text/javascript"></script>
    <script src="{{STATIC_URL}}amcharts/exporting/canvg.js" type="text/javascript"></script>
    <script src="{{STATIC_URL}}amcharts/exporting/rgbcolor.js" type="text/javascript"></script>
    <script src="{{STATIC_URL}}amcharts/exporting/filesaver.js" type="text/javascript"></script>
    <script type="text/javascript">
        var actoresAsociados = arrayToJson("{{actoresAsociadosJSON}}");
        var chartData = [];
        for (i in actoresAsociados){
            var aux = actoresAsociados[i];
            chartData.push(
                {
                    "actor": aux[0],
                    "valor": aux[2],
                    "color": colors[i%colors.length],
                }
            );
        }
        var chart;
        AmCharts.ready(function () {
            // SERIAL CHART
            chart = new AmCharts.AmSerialChart();
            chart.dataProvider = chartData;
            chart.categoryField = "actor";
            chart.startDuration = 1;
            chart.rotate = true;

            // AXES
            // category
            var categoryAxis = chart.categoryAxis;
            categoryAxis.gridPosition = "start";
            categoryAxis.axisColor = "#DADADA";
            categoryAxis.dashLength = 3;

            // value
            var valueAxis = new AmCharts.ValueAxis();
            valueAxis.dashLength = 3;
            valueAxis.axisAlpha = 0.2;
            valueAxis.position = "top";
            valueAxis.title = "Actores en el Sistema";
            valueAxis.minorGridEnabled = true;
            valueAxis.minorGridAlpha = 0.08;
            valueAxis.gridAlpha = 0.15;
            chart.addValueAxis(valueAxis);

            // GRAPHS
            // column graph
            var graph1 = new AmCharts.AmGraph();
            graph1.type = "column";
            graph1.title = "Actores";
            graph1.valueField = "valor";
            graph1.colorField = "color";
            graph1.lineAlpha = 0;
            graph1.fillColors = "#FF0000";
            graph1.fillAlphas = 0.8;
            graph1.balloonText = "<span style='font-size:13px;'>Número de [[category]]:<b>[[value]]</b></span>";
            chart.addGraph(graph1);
            chart.exportConfig = exportConfig();

            // WRITE
            chart.write("chartdiv");
        });
        
    </script>
    <script type="text/javascript">
        datosMostrar = "{{ubicaciones}}";
        posicionInicial = "{{posicionInicial}}";
        mapa = "mapa";
    </script>
    <script type="text/javascript" src="{{STATIC_URL}}js/coldeportes/creacion_google_maps.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?callback=initMap" async defer></script>
{% endblock %}

{% block css %}
    <style>
        .profile-image {
            border: 0;
        }
        #mapa {
            height: 400px;
            width: 100%;
          }
    </style>
{% endblock %}

{% block contenido %}
    <!--Se trae todo el bloque ya que se pueden utilizar mas de un panel-->
    <div class="row" align="center">
        {% for i in actoresAsociados %}
            <div class="col-xs-6 col-sm-4 col-md-2">
                <div class="widget widget-stats bg-{{i.1}}">
                    <div class="stats-title">{{i.0}}</div>
                    <div class="stats-number">{{i.2}}</div>
                    <div class="stats-progress progress">
                        <div class="progress-bar" style="width: 70.1%;"></div>
                    </div>
                    <div class="stats-desc">
                        <a href="{% url i.3 %}" style="color:white">Ver detalles</a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
    <div class="row">
        <div class="col-sm-8">
            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-success">
                        <div class="panel-heading">
                            <div class="panel-heading-btn">
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-success"><i class="fa fa-repeat"></i></a>
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning"><i class="fa fa-minus"></i></a>
                                <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger"><i class="fa fa-times"></i></a>
                            </div>
                            <h4 class="panel-title">
                                Georreferenciación de Escenarios Deportivos y Centros de Acondicionamiento
                            </h4>
                        </div>
                        <div class="panel-body">
                            <div id="mapa"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-sm-4">
            <div class="row">
                <div class="col-md-12">
                    <div id="chartdiv" style="width: 100%; height: 200px;"></div>
                </div>
            </div>
            {% include 'panel_solicitudes.html' %}
        </div>
    </div>
{% endblock %}