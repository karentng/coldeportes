{% extends 'base.html' %}
{% load bootstrap3 %}
{% load i18n %}

{% block titulo %}
    Dirigentes - SND COLDEPORTES
{% endblock %}

{% block css %}
    <link href="{{STATIC_URL}}plugins/bootstrap-wizard/css/bwizard.min.css" rel="stylesheet" />
    <link href="{{STATIC_URL}}plugins/bootstrap-validator/bootstrapValidator.min.css" rel="stylesheet">
    {# {{form.media}} {# js y css para datetime #}
    <style>
    .control-label{
        display: none;
    }
    .form-control-feedback{
        margin-top: -31px;
    }
    #btn-buscar{
        margin-top: -34px;
    }
    #id_identificacion{
        width: 94%;
    }
    </style>
{% endblock %}

{% block js %}
    <!--<script src="{{STATIC_URL}}plugins/bootstrap-wizard/js/bwizard.js"></script>-->
    <!--<script src="{{STATIC_URL}}js/form-wizards.demo.min.js"></script>-->
    <script src="{{STATIC_URL}}js/validaciones/dirigentes/wizard_identificacion-validations.js"></script>
    
    <script type="text/javascript">
        $button = $('<button id="btn-buscar" class="btn btn-primary pull-right" type="button">...</button>');
        $input_identificacion = $('#id_identificacion');
        $input_identificacion.after($button);
        $button.click(function(){
            var identificacion = $input_identificacion.val();
            $.ajax({
                url : '/dirigentes/nuevo/wizard/identificacion',
                type: 'GET',
                dataType: 'json',
                data: {'id_dirigente': identificacion},
                success: function(data){
                    if(data['id_dirigente'] != 'ninguno'){
                        window.location.href = '/dirigentes/nuevo/wizard/identificacion/' + data['id_dirigente'];
                    }else{
                        console.log('no hay nadie');
                        console.log($('#modal-dirigente'));
                        $('#link-modal-dirigente').click();
                    }
                },
                error: function(){
                    console.log('error');
                }
            });
        });
    </script>
{% endblock %}

{% block miga_pan %}
    <li><a href="{% url 'inicio' %}">Inicio</a></li>
    <li><a href="{% url 'dirigentes_listar' %}">Dirigentes</a>
    <li class="active">Registro</li>
{% endblock %}

{% block titulo_panel %}
    Registro Nuevo Dirigente
{% endblock %}

{% block contenido_panel %}
    {% include 'dirigentes/wizard/_wizard.html' %}
    
    <form id="form-wizard-identificacion" action="" method="post" enctype="multipart/form-data">{% csrf_token %}
        <fieldset>
            <div class="well row">
                <legend class="pull-left width-full">
                    {% include 'dirigentes/wizard/_mensajes.html' %}
                </legend>
                <div class="row" >
                    {% for field in form %}
                    <div class="col-md-6">
                        <label for="{{ field.id_for_label }}">{{ field.label }}
                            {% if field.field.required %}<span class="special_class">*</span>{% endif %}
                        </label>
                        {% bootstrap_field field layout="inline" %}
                    </div>
                    {% endfor %}
                </div>
                <div class="row">
                    <div class="col-xs-12">
                        <input class="btn btn-primary pull-right" type="submit" value="{% trans "Siguiente →" %}"/>
                    </div>
                </div>
            </div>
        </fieldset>
    </form>
    <a id="link-modal-dirigente" href="#modal-dirigente" data-toggle="modal"></a>
    <div class="modal fade" id="modal-dirigente">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title">Dirigentes</h4>
                </div>
                <div class="modal-body">
                    No se ha encontrado ningún dirigente con la identificación proporcionada.
                </div>
                <div class="modal-footer">
                    <a href="javascript:;" class="btn btn-sm btn-white" data-dismiss="modal">Aceptar</a>
                </div>
            </div>
        </div>
    </div>
{% endblock %}