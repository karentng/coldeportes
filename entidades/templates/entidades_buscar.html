{% extends 'base.html' %}
{% load bootstrap3 %}

{% block miga_pan %}
    <li><a href="{% url 'inicio' %}">Inicio</a></li>
    <li><a href="">Entidades</a>
    <li class="active">Buscar</li>
{% endblock %}

{% block titulo_contenido %}
    Entidades
{% endblock %}

{% block titulo_panel %}
    <i class="fa fa-qrcode"></i> Buscador de entidades
{% endblock %}

{% block panel_botones %}
{% endblock %}

{% block contenido %}
    <br/>
    <h1 class="page-header">Buscador de Entidades <small>{% if listado_resultados %}{{cantidad_resultados}} {% if cantidad_resultados > 1 %}fueron encontrados {% else %} fue encontrado {% endif %}{% endif %}</small></h1>
    <div class="row">
        <form  method="POST">{% csrf_token %}
            <div class="col-md-10">       
                <div class="col-md-12 add-tooltip"  data-placement="top" data-toggle="tooltip" data-original-title="Ingrese un nombre o palabras claves para buscar una entidad">
                    {% bootstrap_field form.nombre layout="vertical" %}
                </div>
                <h4>Filtros</h4>
                <div class="col-md-4 add-tooltip" data-placement="top" data-toggle="tooltip" data-original-title="Seleccione uno o más tipos de entidad">
                    {% bootstrap_field form.tipo layout="vertical" %}
                </div>
                <div class="col-md-4 add-tooltip" data-placement="top" data-toggle="tooltip" data-original-title="Seleccione una o más disciplinas deportivas">
                    {% bootstrap_field form.disciplina layout="vertical" %}
                </div>
                 <div class="col-md-4 add-tooltip" data-placement="top" data-toggle="tooltip" data-original-title="Seleccione una o más departamentos">
                    {% bootstrap_field form.departamento layout="vertical" %}
                </div>
            </div>
            </br>
            <div class="col-md-1">
                <button type="submit" class="btn btn-primary">
                    <span class="fa fa-search"></span> Buscar
                </button>
            </div>
        </form>
    </div>
    <h4>Resultados</h4>
    {% if primer_resultado %}
        <ul class="result-list">    
        {% for listado in listado_resultados %}
            {% for resultado in listado %}
            <li>
                
                <div class="result-info col-md-9">
                    <h4 class="title">Título de Norma: {{resultado.norma}}</h4>
                    <p class="location"><b>{% if resultado.sectores.all %}Sector:{% for sector in resultado.sectores.all %} {{sector.nombre}}, {% endfor %}{% endif %} Año: {{resultado.anio}}</b></p>
                    <p class="desc">
                        {{resultado.descripcion}}
                    </p>
                    Palabras Clave: <b>{{resultado.palabras_clave}}</b> <br/>
                    Archivo Soporte Norma: <a target="_blank" href="{{MEDIA_URL}}{{resultado.archivo}}"><b>{{resultado.archivo}}</b></a>
                </div>
                <div class="result-price col-md-1">
                    <small>JURISDICCIÓN:</small> {{resultado.get_jurisdiccion_display}}
                    {% if perms.normograma.add_norma %}
                    <a href="{% url 'editar_norma' resultado.id %}" class="btn btn-inverse btn-block" >Editar Norma</a>
                    {% endif %}
                </div>
            </li>
            {% endfor %}
        {% endfor %}
        </ul>
        {% else %}
        <div class="col-md-5"><h5>No hay resultados para la búsqueda.</h5></div><br/><br/><br/><br/><br/>
    {% endif %}

{% endblock %}

{% block css %}       
    <link href="{{STATIC_URL}}plugins/jquery-tag-it/css/jquery.tagit.css" rel="stylesheet" />
    {{form.media}} {# js y css para datetime #}
{% endblock %}

{% block js %}
    <script src="{{STATIC_URL}}plugins/ionRangeSlider/js/ion-rangeSlider/ion.rangeSlider.min.js"></script>
    <script src="{{STATIC_URL}}plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.min.js"></script>
    <script src="{{STATIC_URL}}plugins/masked-input/masked-input.min.js"></script>
    <script src="{{STATIC_URL}}plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js"></script>
    <script src="{{STATIC_URL}}plugins/password-indicator/js/password-indicator.js"></script>
    <script src="{{STATIC_URL}}plugins/bootstrap-combobox/js/bootstrap-combobox.js"></script>
    <script src="{{STATIC_URL}}plugins/bootstrap-select/bootstrap-select.min.js"></script>
    <script src="{{STATIC_URL}}plugins/jquery-tag-it/js/tag-it.min.js"></script>
    <script src="{{STATIC_URL}}plugins/bootstrap-daterangepicker/moment.js"></script>
    <script src="{{STATIC_URL}}plugins/bootstrap-daterangepicker/daterangepicker.js"></script>
    <script src="{{STATIC_URL}}js/form-plugins.demo.min.js"></script>
    <script src="{{STATIC_URL}}js/tooltip.js"></script>

{% endblock %}

{% block script %}
    <script>
        $(document).ready(function() {
            App.init();
            FormPlugins.init();
        });
    </script>

{% endblock %}